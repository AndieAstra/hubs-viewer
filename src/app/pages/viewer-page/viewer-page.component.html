<!-- ðŸ§± Main App Layout -->
<div class="unity-layout">

  <!-- ðŸ“± Sidebar Toggle Button -->
  <button class="sidebar-toggle" (click)="toggleSidebar()">â˜°</button>

  <!-- ðŸ§± Main Body -->
  <div class="main-body">

    <!-- ðŸ“ Sidebar -->
    <aside class="sidebar-left" [class.collapsed]="sidebarCollapsed">

      <!-- ðŸŽ› Top Buttons -->
      <div class="sidebar-button-row">
        <button class="kid-button purple" (click)="startTutorial()">{{ 'BUTTONS.TUTORIAL' | translate }}</button>
        <button class="kid-button danger small" (click)="openBugReport()">{{ 'BUTTONS.BUG_REPORT' | translate }}</button>
      </div>

      <!-- ðŸ“± Mobile VR -->
      <div class="mobile-only-buttons">
        <button class="kid-button green" (click)="enterVRMode()">{{ 'BUTTONS.ENTER_VR' | translate }}</button>
        @if (viewer.isVRMode) {
          <button class="kid-button danger" (click)="exitVRMode()">{{ 'BUTTONS.EXIT_VR' | translate }}</button>
        }
      </div>

      <!-- ðŸ”§ Scene Settings -->
      <section>
        <h4>{{ 'SECTIONS.SCENE_SETTINGS' | translate }}</h4>
        <div class="button-row">

          <button class="kid-button" (click)="resetView()">
            <img src="assets/icons/new_rotate.png" alt="Reset Camera" />
            <span>{{ 'BUTTONS.RESET_CAMERA' | translate }}</span>
          </button>

          <!-- Load Scene -->
          <button class="kid-button purple" (click)="onUploadClick()">
            <img src="assets/icons/upload.png" alt="Load" />
            <span>{{ 'BUTTONS.LOAD_SCENE' | translate }}</span>
          </button>

          <!-- Save Scene -->
          <button class="kid-button green" (click)="saveScene()">
            <img src="assets/icons/save.jpg" alt="Save" />
            <span>{{ 'BUTTONS.SAVE_SCENE' | translate }}</span>
          </button>

          <!-- Hidden File Input -->
          <input type="file" #fileInput style="display: none" (change)="onFileChange($event)" accept=".glb,.gltf,.json" />
        </div>
      </section>

      <!-- ðŸ’¡ Lighting -->
      <section>
        <h4>{{ 'SECTIONS.LIGHTING' | translate }}</h4>
        <div class="button-row">

          <label class="kid-button green color-picker-label">
            <input type="color" (change)="onLightColorChange($event)" class="color-input" />
            <img src="assets/icons/reset.png" alt="Light Color" />
            <span>{{ 'BUTTONS.SUNLIGHT_COLOR' | translate }}</span>
          </label>

          <button class="kid-button orange" (click)="toggleRoomLight()">
            <img src="assets/icons/wire.jpg" alt="Room Light" />
            <span>{{ 'BUTTONS.ROOM_LIGHT' | translate }}</span>
          </button>

          <div class="kid-slider">
            <label>{{ 'SLIDERS.SUNLIGHT' | translate }}</label>
            <input type="range" (input)="onSunlightInput($event)" />
          </div>
        </div>
      </section>

      <!-- ðŸ“ Model Settings -->
      <section>
        <h4>{{ 'SECTIONS.MODEL_SETTINGS' | translate }}</h4>
        <div class="button-row">

          <button class="kid-button" (click)="toggleWireframe()">
            <img src="assets/icons/new_rotate.png" alt="Wireframe" />
            <span>{{ 'BUTTONS.TOGGLE_WIREFRAME' | translate }}</span>
          </button>

          <div class="kid-slider">
            <label>{{ 'SLIDERS.MODEL_SIZE' | translate }}</label>
            <input type="range" (input)="onModelSizeInput($event)" />
          </div>

          <div class="kid-slider">
            <label>{{ 'SLIDERS.MODEL_HEIGHT' | translate }}</label>
            <input type="range" (input)="onModelHeightInput($event)" />
          </div>
        </div>
      </section>

      <!-- ðŸŽ¥ Camera Movement -->
      <section>
        <h4>{{ 'SECTIONS.CAMERA_MOVEMENT' | translate }}</h4>
        <div class="button-row">


          <div class="kid-slider">
          <label for="speedControl">{{ 'SLIDERS.SPEED' | translate }}</label>
          <input
            id="speedControl"
            type="range"
            min="0.5"
            max="6"
            step="0.1"
            (input)="onSpeedInput($event)"
            />
            </div>

          <div class="kid-slider">
            <label>{{ 'SLIDERS.EYE_LEVEL' | translate }}</label>
            <input  type="range"
                    min="0.5"
                    max="8.0"
                    step="0.05"
                    [value]="1.6"
                    (input)="onEyeLevelInput($event)"
                />
          </div>


        </div>
      </section>

    </aside>

    <!-- ðŸ–¼ï¸ Canvas Area -->
    <section class="canvas-container">
      <app-viewer #viewer></app-viewer>

      <!-- ðŸ‘“ Exit VR Button -->
      @if(viewer.isVRMode) {
        <button class="vr-exit-button" (click)="exitVRMode()">
          âœ• {{ 'BUTTONS.EXIT_VR' | translate }}
        </button>
      }

      <!-- â›” Exit Fullscreen Button -->
      @if(viewer.isInFullscreen && !viewer.isVRMode) {
        <button class="fullscreen-exit-button" (click)="exitFullscreen()">
          âœ• {{ 'BUTTONS.EXIT_FULLSCREEN' | translate }}
        </button>
      }
    </section>

  </div>

  <!-- ðŸ“Œ Bottom Console -->
  <footer class="bottom-bar">
    <div class="tabs">
      <button (click)="toggleConsole()">
        {{ 'CONSOLE.TOGGLE' | translate }} {{ showConsole ? 'â–¼' : 'â–²' }}
      </button>
    </div>

    @if (showConsole) {
      <div class="assets-browser">
        <div class="assets-tree">
          <ul class="error-bar">
            @for (message of consoleMessages; track message) {
              <li>{{ message }}</li>
            }
          </ul>
        </div>
      </div>
    }
  </footer>

</div>
