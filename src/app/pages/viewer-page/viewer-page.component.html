<div class="unity-layout">

  <!-- 🔝 Top Toolbar -->
  <header class="top-toolbar">
    <div class="toolbar-center">

<div class="upload-instructions">
  <p><strong>{{ 'UPLOAD.INSTRUCTIONS' | translate }}</strong></p>
  <button (click)="onUploadClick()">{{ 'UPLOAD.BUTTON_LABEL' | translate }}</button>
  <input type="file" hidden #fileInput (change)="onFileChange($event)" accept=".glb,.gltf,.json" />
</div>
</div>

    <!-- 📱 Sidebar Toggle Button -->
    <button class="sidebar-toggle" (click)="toggleSidebar()">☰</button>
  </header>

  <!-- 🧱 Main Layout -->
  <div class="main-body">

    <!-- 📁 Sidebar -->
    <aside class="sidebar-left" [class.collapsed]="sidebarCollapsed">

      <!-- 🎛 Top Buttons -->
      <div class="sidebar-button-row">
        <button class="kid-button purple" (click)="startTutorial()">{{ 'BUTTONS.TUTORIAL' | translate }}</button>
        <button class="kid-button danger small" (click)="openBugReport()">{{ 'BUTTONS.BUG_REPORT' | translate }}</button>
      </div>

      <!-- 📱 Mobile VR -->
      <div class="mobile-only-buttons">
        <button class="kid-button green" (click)="enterVRMode()">{{ 'BUTTONS.ENTER_VR' | translate }}</button>
        @if (viewerRef?.isVRMode) {
          <button class="kid-button danger" (click)="exitVRMode()">{{ 'BUTTONS.EXIT_VR' | translate }}</button>
        }
      </div>

      <!-- 🔧 Scene -->
      <section>
        <h4>{{ 'SECTIONS.SCENE_SETTINGS' | translate }}</h4>
        <div class="button-row">

          <button class="kid-button" (click)="resetView()">
            <img src="assets/icons/new_rotate.png" alt="Reset Camera" />
            <span>{{ 'BUTTONS.RESET_CAMERA' | translate }}</span>
          </button>

          <input
          type="file"
          accept=".json"
          hidden #fileInput
          (change)="onFileChange($event)" />

          <button class="kid-button purple" (click)="fileInput.click()">
            <img src="assets/icons/upload.png" alt="Load" />
            <span>{{ 'BUTTONS.LOAD_SCENE' | translate }}</span>
          </button>

        <button class="kid-button green" (click)="saveSceneAsJson()">
          <img src="assets/icons/save.jpg" alt="Save" />
          <span>{{ 'BUTTONS.SAVE_SCENE' | translate }}</span>
        </button>
        </div>
        </section>


      <!-- 💡 Lighting -->
      <section>
        <h4>{{ 'SECTIONS.LIGHTING' | translate }}</h4>
        <div class="button-row">
          <button class="kid-button green" (click)="toggleLightcolor()">
            <img src="assets/icons/reset.png" alt="Light Color" />
            <span>{{ 'BUTTONS.SUNLIGHT_COLOR' | translate }}</span>
          </button>

          <button class="kid-button orange" (click)="toggleRoomLight()">
            <img src="assets/icons/wire.jpg" alt="Room Light" />
            <span>{{ 'BUTTONS.ROOM_LIGHT' | translate }}</span>
          </button>

          <div class="kid-slider">
            <label>{{ 'SLIDERS.SUNLIGHT' | translate }}</label>
            <input type="range" (input)="onSunlightInput($event)" />
          </div>
        </div>
      </section>

      <!-- 📐 Model Settings -->
      <section>
        <h4>{{ 'SECTIONS.MODEL_SETTINGS' | translate }}</h4>
        <div class="button-row">
          <button class="kid-button" (click)="toggleWireframe()">
            <img src="assets/icons/new_rotate.png" alt="Wireframe" />
            <span>{{ 'BUTTONS.TOGGLE_WIREFRAME' | translate }}</span>
          </button>

          <div class="kid-slider">
            <label>{{ 'SLIDERS.MODEL_SIZE' | translate }}</label>
            <input type="range" (input)="onModelSizeInput($event)" />
          </div>

          <div class="kid-slider">
            <label>{{ 'SLIDERS.MODEL_HEIGHT' | translate }}</label>
            <input type="range" (input)="onModelHeightInput($event)" />
          </div>
        </div>
      </section>

      <!-- 🎥 Camera Movement -->
      <section>
        <h4>{{ 'SECTIONS.CAMERA_MOVEMENT' | translate }}</h4>
        <div class="button-row">
          <div class="kid-slider">
            <label>{{ 'SLIDERS.SPEED' | translate }}</label>
            <input type="range" (input)="onSpeedInput($event)" />
          </div>

          <div class="kid-slider">
            <label>{{ 'SLIDERS.EYE_LEVEL' | translate }}</label>
            <input type="range" (input)="onEyeLevelInput($event)" />
          </div>
        </div>
      </section>
    </aside>


    <!-- 🖼️ Canvas -->
    <section class="canvas-container">
      <app-viewer [glbFile]="selectedFile" #viewerRef></app-viewer>

      <!-- 👓 Exit VR Button -->
      @if(viewerRef?.isVRMode) {
        <button class="vr-exit-button" (click)="exitVRMode()">
          ✕ {{ 'BUTTONS.EXIT_VR' | translate }}
        </button>
      }

      <!-- ⛔ Exit Fullscreen Button -->
      @if(viewerRef?.isInFullscreen && !viewerRef?.isVRMode) {
        <button class="fullscreen-exit-button" (click)="exitFullscreen()">
          ✕ {{ 'BUTTONS.EXIT_FULLSCREEN' | translate }}
        </button>
      }
    </section>
  </div>

  <!-- 📌 Bottom Console -->
  <footer class="bottom-bar">
    <div class="tabs">
      <button (click)="toggleConsole()">
        {{ 'CONSOLE.TOGGLE' | translate }} {{ showConsole ? '▼' : '▲' }}
      </button>
    </div>

    @if (showConsole) {
      <div class="assets-browser">
        <div class="assets-tree">
          <ul class="error-bar">
            @for (message of consoleMessages; track message) {
              <li>{{ message }}</li>
            }
          </ul>
        </div>
      </div>
    }
  </footer>
</div>
